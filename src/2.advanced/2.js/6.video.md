---
lang: zh-CN
sidebarDepth: 2
meta:
  - name: description
    content: 个人总结的vuepress学习技术文档-语法
  - name: keywords
    content: vuepress,最新技术文档,vuepress语法,markdown语法
---

# 六.Video

## 前置摄像头

::: demo

```html
<style>
  #video1 {
    min-height: 240px;
    width: 100%;
  }
</style>
<button onclick="openDevice1()">打开视频</button>
<video id="video1" controls autoplay></video>
<script>
  async function openDevice1() {
    let stream1 = await navigator?.mediaDevices?.getUserMedia({
      video: true,
      audio: true,
    })
    try {
      var video1 = document.getElementById("video1")
      video1["srcObject"] = stream1
      video1.play()
    } catch (e) {
      console.log("错误信息：" + e)
    }
  }
</script>
```

:::

## 后置摄像头

::: demo

```html
<style>
  #video2 {
    min-height: 240px;
    width: 100%;
  }
</style>
<button onclick="openDevice2()">打开视频</button>
<video id="video2" controls autoplay></video>
<script>
  async function openDevice2() {
    let stream2 = await navigator?.mediaDevices?.getUserMedia({
      audio: true,
      video: { facingMode: { exact: "environment" } },
    })
    try {
      var video2 = document.getElementById("video")
      video2["srcObject"] = stream2
      video2.play()
    } catch (e) {
      console.log("错误信息：" + e)
    }
  }
</script>
```

:::

## 拍照

::: demo

```html
<!--video用于显示媒体设备的视频流，自动播放-->
<video id="video" autoplay style="width: 480px;height: 320px"></video>
<!--拍照按钮-->
<div>
  <button id="capture">拍照</button>
</div>
<!--描绘video截图-->
<canvas id="canvas" width="480" height="320"></canvas>
<script>
  //访问用户媒体设备的兼容方法
  function getUserMedia(constrains, success, error) {
    if (navigator.mediaDevices.getUserMedia) {
      //最新标准API
      navigator.mediaDevices.getUserMedia(constrains).then(success).catch(error)
    } else if (navigator.webkitGetUserMedia) {
      //webkit内核浏览器
      navigator.webkitGetUserMedia(constrains).then(success).catch(error)
    } else if (navigator.mozGetUserMedia) {
      //Firefox浏览器
      navagator.mozGetUserMedia(constrains).then(success).catch(error)
    } else if (navigator.getUserMedia) {
      //旧版API
      navigator.getUserMedia(constrains).then(success).catch(error)
    }
  }

  var video = document.getElementById("video")
  var canvas = document.getElementById("canvas")
  var context = canvas.getContext("2d")

  //成功的回调函数
  function success(stream) {
    //兼容webkit内核浏览器
    var CompatibleURL = window.URL || window.webkitURL
    //将视频流设置为video元素的源
    video.src = CompatibleURL.createObjectURL(stream) // 此处的代码将会报错  解决的办法是将video的srcObject属性指向stream即可
    //播放视频
    video.play()
  }

  //异常的回调函数
  function error(error) {
    console.log("访问用户媒体设备失败：", error.name, error.message)
  }
  if (
    navigator.mediaDevices.getUserMedia ||
    navigator.getUserMedia ||
    navigator.webkitGetUserMedia ||
    navigator.mozGetUserMedia
  ) {
    //调用用户媒体设备，访问摄像头
    getUserMedia(
      {
        video: { width: 480, height: 320 },
      },
      success,
      error
    )
  } else {
    alert("你的浏览器不支持访问用户媒体设备")
  }

  //注册拍照按钮的单击事件
  document.getElementById("capture").addEventListener("click", function () {
    //绘制画面
    context.drawImage(video, 0, 0, 480, 320)
  })
</script>
```

:::
